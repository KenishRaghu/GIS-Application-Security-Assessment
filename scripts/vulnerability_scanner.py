"""
Automated vulnerability scanning for GIS application.
Integrates with BurpSuite for scan execution and result processing.
Improves security testing efficiency via automation.
"""

import json
import sys
from pathlib import Path


def load_burp_scan_results(results_path: str) -> list:
    """Load and parse BurpSuite scan results (JSON export)."""
    path = Path(results_path)
    if not path.exists():
        return []
    with open(path, encoding="utf-8") as f:
        data = json.load(f)
    return data.get("issues", data) if isinstance(data, dict) else data


def summarize_findings(issues: list) -> dict:
    """Summarize findings by severity for reporting."""
    summary = {"high": 0, "medium": 0, "low": 0, "info": 0}
    for issue in issues:
        if isinstance(issue, dict):
            sev = (issue.get("severity") or "info").lower()
            summary[sev] = summary.get(sev, 0) + 1
    return summary


def main():
    if len(sys.argv) > 1:
        issues = load_burp_scan_results(sys.argv[1])
    else:
        issues = []
    summary = summarize_findings(issues)
    print("Vulnerability scan summary:", summary)
    return 0


if __name__ == "__main__":
    sys.exit(main())
